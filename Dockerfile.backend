# Multi-stage Dockerfile for backend (Rust)

FROM rust:1.75-alpine AS builder
RUN apk add --no-cache musl-dev openssl-dev pkgconfig
WORKDIR /app
COPY backend/ ./backend/
WORKDIR /app/backend
RUN cargo build --release

FROM gcr.io/distroless/cc-debian12:nonroot
WORKDIR /app
COPY --from=builder /app/backend/target/release/reconciliation-backend /app/app
USER nonroot
EXPOSE 2000
ENV RUST_LOG=info
CMD ["/app/app"]


